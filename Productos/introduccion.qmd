---
title: "Terremotos a nivel mundial desde 1965-2016"
author: "Francisco Fernández"
format: html
editor: visual
---

## Introducción

Los terremotos son liberaciones de energía que se emiten a la superficie de la tierra, debido al choque o roce de las placas tectónicas, y puede provocar daños de gran medida los cuales, afectan directamente a ciudades y zonas rurales. Además origina otros desastres naturales, tales como, derrumbes o tsunamis. Como todos saben, estos desastres son una latente amenaza para las personas, ya que no se pueden predecir.

Por esta razón, algunas de las preguntas más comunes que se plantean son: A pesar de que los terremotos no se pueden predecir, ¿existe algún patron en la frecuencia de este fenómeno?, ¿cuántos sismos ocurren aproximadamente en un año?, ¿hay una hora en donde se originan más temblores? y si es esto correcto, ¿cuál es?

Gracias al Centro De Sismología Internacional (CSI), la organización mundial, que se encarga de registrar la magnitud, y la localización de los sismos. Es por ello que con la labor de esta organización se puede usar esta información recopilada, para hacer innovaciones que podrían prevenir catástrofes graves, por ejemplo, cambiando las estructuras de hormigón de los edificios y las casas de tal forma que sean estables ante las ondas sísmicas, o construir muros anti tsunami para romper las olas que se acercan a la costa.

Dejando esto claro, en este informe se realizará un análisis estadístico descriptivo con datos recopilados por la CSI, con el objetivo de entregar información sobre los países con mayor actividad sísmica y también determinar un intervalo sobre la profundidad en que se originan los terremotos. Se espera así conocer cuáles son los países que requieren innovaciones frente a los sismos.

Este trabajo se divide en cuatro secciones. Primero se dará información y contexto sobre qué son los terremotos y por qué es importante hacer mediciones sobre estos fenómenos . Luego se dará una explicación de cada variable disponible en la base del CSI. En la tercera parte se entregarán gráficos, tablas y análisis sobre los terremotos. Y en último lugar, se realizará una conclusión en la que se identificarán posibles patrones en la magnitud, frecuencia y hora de los terremotos.

## Descripción de variables

La siguiente tabla muestra las variables que se usarán en el análisis , a que tipo corresponden, y una breve definición sobre la información que entregan.

```{r}
#| echo: false

library(gt)
nombres <- c("Fecha","Hora","Latitud","Longitud",
          "Magnitud","País") 
data.frame(Variables= nombres, 
           Tipo = c("Fecha",
                    "Tiempo",
                    "Numérico",
                    "Numérico",
                    "Numérico",
                    "Carácter"),
           Descripción = c(
             "Muestra la fecha en que ocurrió el sismo",
             "Entrega la hora en que se originó un terremoto",
             "Señala la latitud como coordenada geográfica ",
             "Señala la longitud como coordenada geográfica",
             "Es la magnitud en escala Richter de los terremotos",
             "Corresponde al país en el que sucedió el sismo") ) |> 
  gt() |> 
  tab_header(title = "Descripción de variables") |> 
  tab_source_note(source_note = "Fuente: Kaggle.com")
```

Se puede apreciar varios tipos de variables, pero en este trabajo se usarán en su mayoria las columnas que contienen la fechas, horas, magnitudes, y países en las que ocurrieron los terremotos. Para este estudio, solo se considerarán los terremotos con magnitud mayor a 5,5.

## Gráficos

Se quiere estudiar la cantidad de terremotos que hay en el mundo, y su relación con variables, tales como año, magnitud, hora, etc. Para ello se adjuntarán gráficos y tablas que entregarán información sobre la frecuencia de los sismos.

```{r}
#| echo: false
#| output: false


library(gtsummary)
library(gt)
library(readxl)
library(readr)
library(dplyr)        
library(tidyr)        
library(stringr) 
library(ggplot2)
library(forcats)
library(ggtext)  
library(gghighlight) 
library(showtext)
library(ggthemes)
library(plotrix)
library(zoom)
library(countrycode)

datos <- read_csv("https://raw.githubusercontent.com/Franciscofn123/Trabajo-Let/main/Datos/terremotos_sin_procesar.csv", show_col_types = FALSE)

v <- data.frame(datos$Date,datos$Time,datos$Latitude,datos$Longitude,datos$Type,datos$Magnitude)




q <- read_csv("/Users/joelf/OneDrive/Documentos/let/Trabajo-Let/Datos/País.csv",show_col_types = FALSE) 

v <- cbind(v,q)



#cambiar nombre de variables
names(v)= c("Fecha", "Hora","Latitud","Longitud", "Tipo", "Magnitud", "País")

#Traducir nombres de paises----

v[v=="Fr. S. Antarctic Lands"] <- "Tierras Antárticas Francesas"
v[v=="S. Sudan"] <- "South Sudan"
v[v=="Somaliland"] <- "Somalia"
v <- v |> 
  mutate(País = countrycode(sourcevar = País,
                               origin = "country.name",
                               destination = "cldr.name.es"),
         .after = País) 


######## se dejan las variables que se quieren ocupar, tiempo, latitud, longitud, magnitud, tipo y pais de origen



####### se trasforma hora de terremoto a hora, para saber a que hora fue (como funcion parte entera)
v$Hora <- format(as.POSIXct(v$Hora), format = "%H")
v$Hora <- as.numeric(v$Hora)

####### tambien se trasforma las fechas a años, para asi saber cuantos terremotos hay a medida que pasa el tiempo
v$Fecha <- as.numeric(substring(v$Fecha,first = 7))

v$Fecha[20651] <- 2011
v$Fecha[7513] <- 1985 
v$Fecha[3379] <- 1975

```

Uno de los objetivos de este trabajo es conocer el número de sismos que hay en el periodo de un año, para así conocer el rango de repetición de estos fenomenos. Con este propósito se adjunta el siguiente gráfico que entrega la cantidad de terremotos que hay en el mundo en cada año, desde 1965 hasta 2016:

```{r}
#| echo: false
library(ggplot2)
v |> 
  filter(Tipo=="Earthquake") |> 
  ggplot(aes(x=Fecha))+
  geom_bar(fill = "#79d0cc", size = 1) +
  labs(title = "Cantidad de terremotos en el mundo por año",
       subtitle = "período entre 1965 y 2016",
       y ="Cantidad",
       x = "Años")+
  scale_x_continuous(breaks = seq(1965, 2016, by = 5))+
    geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "Black",size=1.8)

```

Se puede apreciar, que el 2011 fue el año con la mayor cantidad de sismos en el planeta, con un total de 713 terremotos, esto se puede deber a las replicas que fueron originadas por el terremoto de magnitud 9,1 en Japón, el día 11 de marzo. Por el contrario, el año con la menor cantidad de sismos fue en 1965 con la suma de 233 temblores, esto podría explicarse a que en esa época no existía aún la tecnología necesaria para recopilar todos los terremotos que ocurrían en el mundo.

```{r}
#| echo: false
v |> 
  filter(Tipo=="Earthquake", País=="Chile") |> 
  ggplot(aes(x=Fecha))+
  geom_bar(fill = "#79d0cc", size = 1)+ 
labs(title = "Cantidad de terremotos que ocurren por año en Chile ",
     subtitle = "período entre 1965 y 2016",
     y ="Cantidad",
     x = "Años")+
  scale_x_continuous(breaks = seq(1965, 2016, by = 5))+
      geom_text(aes(label = ..count..), stat = "count", vjust = 1.5, colour = "Black",size=1.8)

```

```{r}
#| echo: false
v <- v[-7513,]
v <- v[-3379,]
v <- v[-20649,]



v |> 
  filter(Tipo=="Earthquake") |> 
  ggplot(aes(x=Hora))+
  geom_bar(color="black",fill="#FF7F50")+
  theme_bw()+
  labs(title = "Número de sismos en el mundo según la hora en que se origina",
       subtitle = "período entre 1965 y 2016", y="Cantidad", x= "Hora (0-24)")
```

```{r}
#| echo: false
library(gtsummary)
library(gt)


#encontrar maximos en magnitud por año

mayores <- v[order(v$Magnitud, decreasing = TRUE),]
mayores<- mayores[c(1,2,3,4,5),]
mayores <- mayores[,c(1,6,7)]


#tabla 5 mayores terremotos en el periodo estudiado
gt(mayores)
```
